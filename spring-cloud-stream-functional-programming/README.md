## Spring Cloud Stream Using Functional Programming

### The technolgies used
- Docker.
- Spring boot 2.5.4 (Stable version at the time of this tuitorial).
- Java 11.
- Apache Kafka and zookeeper (Embedded from docker).

### To start zookeeper and kafka using docker
Go to root directory of project
``` shell
$ docker-compose up -d
```

Start main class as spring boot application, the application will be successful.
Here is the console looks like as the producer will run for every 5 seconds will generate a random number and publishes to final topic that is intended for consumption.

``` log
/Library/Java/JavaVirtualMachines/jdk-11.0.9.jdk/Contents/Home/bin/java -XX:TieredStopAtLevel=1 -noverify -Dspring.output.ansi.enabled=always -javaagent:/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar=50485:/Applications/IntelliJ IDEA.app/Contents/bin -Dcom.sun.management.jmxremote -Dspring.jmx.enabled=true -Dspring.liveBeansView.mbeanDomain -Dspring.application.admin.enabled=true -Dfile.encoding=UTF-8 -classpath /Users/ereshgorantla/Documents/Dev/My Work/medium/spring-cloud/spring-cloud-stream-examples/spring-cloud-stream-functional-programming/build/classes/java/main:/Users/ereshgorantla/Documents/Dev/My Work/medium/spring-cloud/spring-cloud-stream-examples/spring-cloud-stream-functional-programming/build/resources/main:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.projectlombok/lombok/1.18.20/18bcea7d5df4d49227b4a0743a536208ce4825bb/lombok-1.18.20.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-web/2.5.4/2bef2cedf2e0d1038ab51a2c6154579c5945e60c/spring-boot-starter-web-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream-binder-kafka/3.1.3/1e9f7d64c5b02db43d895b32e78de0fa0e25841f/spring-cloud-stream-binder-kafka-3.1.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream/3.1.3/16a73a4f88df83421f19061251ce8d9081317049/spring-cloud-stream-3.1.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.kafka/spring-kafka/2.7.6/3d1008cbad8c9774fbaba2728dfe67fca0ad8deb/spring-kafka-2.7.6.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-json/2.5.4/6bf89f94c5d2455689d8649a3ead440d05e0c8f7/spring-boot-starter-json-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter/2.5.4/d5028e89214b204e39e5920ae118d69293ac3d8a/spring-boot-starter-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-tomcat/2.5.4/57c1254fe8630619f17ff0ed37d4ffdfd0528c20/spring-boot-starter-tomcat-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-webmvc/5.3.9/c3cd1f0bba2658995e887d2f0011ab9bd3da1773/spring-webmvc-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-web/5.3.9/88c920ec1bda67fea04daa8e16165777440df473/spring-web-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream-binder-kafka-core/3.1.3/ecfed273f077207458fa91e2b3c4c6c87a6144fa/spring-cloud-stream-binder-kafka-core-3.1.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.kafka/kafka-clients/2.7.1/11c152973cbf7367cae6f61a4d2584bf5a774451/kafka-clients-2.7.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-validation/2.5.4/8acfe1b2d2a111e278ee92f10d809dd1e63a7381/spring-boot-starter-validation-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-jmx/5.5.3/23b6d28fc372954a53da0d97b58df0b1f77ea5c7/spring-integration-jmx-5.5.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-core/5.5.3/769b34e14f0b8e84981f1ff2a5dee80b4cc50310/spring-integration-core-5.5.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-function-context/3.1.3/f0d56787829c8b1d18d382d330d3003d04c5f567/spring-cloud-function-context-3.1.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-messaging/5.3.9/bcce428a1648c8b8814203bcc6dee1028280b6f6/spring-messaging-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.retry/spring-retry/1.3.1/f8644c86f2be54623c3b336a56b54216841a3f22/spring-retry-1.3.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-context/5.3.9/887f4579ade4f47cf0102856f4f4c88eda8ec9d7/spring-context-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-tx/5.3.9/a7057cf30368d014a1c8e5880a128703c890ec79/spring-tx-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.datatype/jackson-datatype-jsr310/2.12.4/b1174c05d4ded121a7eaeed3f148709f9585b981/jackson-datatype-jsr310-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.module/jackson-module-parameter-names/2.12.4/87c4e9a3302f0fafe4e5587f9c27d22847d8fe00/jackson-module-parameter-names-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.datatype/jackson-datatype-jdk8/2.12.4/858a1e1b677cbafd3b100d5154f491a7051401c/jackson-datatype-jdk8-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-databind/2.12.4/69206e02e6a696034f06a59d3ddbfbba5a4cd81/jackson-databind-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-autoconfigure/2.5.4/3fe555faa956fa8b63b0d0115bb0ed55e4509b5e/spring-boot-autoconfigure-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot/2.5.4/b8d09303fa30f5102f33bcf2fa64b66be8fa39ba/spring-boot-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-logging/2.5.4/bef5da8f5610ca83dcefead706d66be09b9ef55d/spring-boot-starter-logging-2.5.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/jakarta.annotation/jakarta.annotation-api/1.3.5/59eb84ee0d616332ff44aba065f3888cf002cd2d/jakarta.annotation-api-1.3.5.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-core/5.3.9/cfef19d1dfa41d56f8de66238dc015334997d573/spring-core-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.yaml/snakeyaml/1.28/7cae037c3014350c923776548e71c9feb7a69259/snakeyaml-1.28.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.tomcat.embed/tomcat-embed-websocket/9.0.52/557c15720af6f8d59a8308ce290f4408b5325194/tomcat-embed-websocket-9.0.52.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.tomcat.embed/tomcat-embed-core/9.0.52/501d876042f7bff64ee42cf1849e4abea272632/tomcat-embed-core-9.0.52.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.tomcat.embed/tomcat-embed-el/9.0.52/ee51a2bab9b9c055f857fef0926116e8f459e8cc/tomcat-embed-el-9.0.52.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-aop/5.3.9/9bcad31a74e60d205500dd67d2220bd0195c63f8/spring-aop-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-beans/5.3.9/48600db2cb1abc0f7ef2b073f0c1abd78a83bcfc/spring-beans-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-expression/5.3.9/f5ca763cfb9d62d196efd5d25e8daca7d555ed75/spring-expression-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-kafka/5.5.3/7c63568b5dee86417a1fcac40aa395f1abbcc826/spring-integration-kafka-5.5.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.github.luben/zstd-jni/1.4.5-6/3213bb3b3f54644817f422bda3be347eaf4915a7/zstd-jni-1.4.5-6.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.lz4/lz4-java/1.7.1/c4d931ef8ad2c9c35d65b231a33e61428472d0da/lz4-java-1.7.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.xerial.snappy/snappy-java/1.1.7.7/43d5dbd718e6b0b1f0c8b234f2a9bb6385b8afde/snappy-java-1.1.7.7.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.slf4j/slf4j-api/1.7.32/cdcff33940d9f2de763bc41ea05a0be5941176c3/slf4j-api-1.7.32.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.hibernate.validator/hibernate-validator/6.2.0.Final/d6b0760dfffbf379cedd02f715ff4c9a2e215921/hibernate-validator-6.2.0.Final.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/io.projectreactor/reactor-core/3.4.9/820332aa7b0fe3a8dfe14f58fc16e49ad178291/reactor-core-3.4.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-function-core/3.1.3/d1f3407deb8d5f4a3e93c735f7070e4e8a3b4311/spring-cloud-function-core-3.1.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/net.jodah/typetools/0.6.2/d1e38fe8e668f228b0761d80a6c80c151ab6044a/typetools-0.6.2.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-annotations/2.12.4/752cf9a2562ac2c012e48057e3a4c17dad66c66e/jackson-annotations-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-core/2.12.4/6a1bd259b6c4e3f9219ec8ec0be55ed11eed0c/jackson-core-2.12.4.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/ch.qos.logback/logback-classic/1.2.5/30e0c3932f24fb10e7851dd308a3ad14e570d60/logback-classic-1.2.5.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-to-slf4j/2.14.1/ce8a86a3f50a4304749828ce68e7478cafbc8039/log4j-to-slf4j-2.14.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.slf4j/jul-to-slf4j/1.7.32/8a055c04ab44e8e8326901cadf89080721348bdb/jul-to-slf4j-1.7.32.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.springframework/spring-jcl/5.3.9/622eb12c98768b6d3acc71ce06bac8b332607a10/spring-jcl-5.3.9.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/jakarta.validation/jakarta.validation-api/2.0.2/5eacc6522521f7eacb081f95cee1e231648461e7/jakarta.validation-api-2.0.2.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.jboss.logging/jboss-logging/3.4.2.Final/e517b8a93dd9962ed5481345e4d262fdd47c4217/jboss-logging-3.4.2.Final.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.fasterxml/classmate/1.5.1/3fe0bed568c62df5e89f4f174c101eab25345b6c/classmate-1.5.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.reactivestreams/reactive-streams/1.0.3/d9fb7a7926ffa635b3dcaa5049fb2bfa25b3e7d0/reactive-streams-1.0.3.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/ch.qos.logback/logback-core/1.2.5/3e149d9c476be313030faf12d76a82c8a0e97f04/logback-core-1.2.5.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-api/2.14.1/cd8858fbbde69f46bce8db1152c18a43328aae78/log4j-api-2.14.1.jar:/Users/ereshgorantla/Documents/Dev/gradle-6.5.1/caches/modules-2/files-2.1/com.google.code.findbugs/jsr305/3.0.2/25ea2e8b0c338a877313bd4672d3fe056ea78f0d/jsr305-3.0.2.jar com.cloud.stream.SpringCloudStreamFunctionalProgrammingApplication

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.5.4)

2021-08-26 12:40:26.830  INFO 2917 --- [           main] udStreamFunctionalProgrammingApplication : Starting SpringCloudStreamFunctionalProgrammingApplication using Java 11.0.9 on Ereshs-MacBook-Pro.local with PID 2917 (/Users/ereshgorantla/Documents/Dev/My Work/medium/spring-cloud/spring-cloud-stream-examples/spring-cloud-stream-functional-programming/build/classes/java/main started by ereshgorantla in /Users/ereshgorantla/Documents/Dev/My Work/medium/spring-cloud/spring-cloud-stream-examples)
2021-08-26 12:40:26.832  INFO 2917 --- [           main] udStreamFunctionalProgrammingApplication : No active profile set, falling back to default profiles: default
2021-08-26 12:40:27.362  INFO 2917 --- [           main] faultConfiguringBeanFactoryPostProcessor : No bean named 'errorChannel' has been explicitly defined. Therefore, a default PublishSubscribeChannel will be created.
2021-08-26 12:40:27.372  INFO 2917 --- [           main] faultConfiguringBeanFactoryPostProcessor : No bean named 'integrationHeaderChannelRegistry' has been explicitly defined. Therefore, a default DefaultHeaderChannelRegistry will be created.
2021-08-26 12:40:27.420  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.integration.config.IntegrationManagementConfiguration' of type [org.springframework.integration.config.IntegrationManagementConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.426  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationJmxConfiguration' of type [org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationJmxConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.433  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration' of type [org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.436  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'mbeanServer' of type [com.sun.jmx.mbeanserver.JmxMBeanServer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.447  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'integrationChannelResolver' of type [org.springframework.integration.support.channel.BeanFactoryChannelResolver] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.448  INFO 2917 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'integrationDisposableAutoCreatedBeans' of type [org.springframework.integration.config.annotation.Disposables] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-08-26 12:40:27.651  INFO 2917 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9001 (http)
2021-08-26 12:40:27.658  INFO 2917 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2021-08-26 12:40:27.659  INFO 2917 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-08-26 12:40:27.725  INFO 2917 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2021-08-26 12:40:27.725  INFO 2917 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 866 ms
2021-08-26 12:40:28.188  INFO 2917 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Creating binder: kafka
2021-08-26 12:40:28.277  INFO 2917 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Caching the binder: kafka
2021-08-26 12:40:28.277  INFO 2917 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Retrieving cached binder: kafka
2021-08-26 12:40:28.304  INFO 2917 --- [           main] o.s.c.s.m.DirectWithAttributesChannel    : Channel 'application.fizzBuzzProcessor-in-0' has 1 subscriber(s).
2021-08-26 12:40:28.305  INFO 2917 --- [           main] reactor.Flux.Map.1                       : onSubscribe(FluxMap.MapSubscriber)
2021-08-26 12:40:28.306  INFO 2917 --- [           main] reactor.Flux.Map.1                       : request(unbounded)
2021-08-26 12:40:28.311  INFO 2917 --- [           main] o.s.c.s.m.DirectWithAttributesChannel    : Channel 'application.fizzBuzzConsumer-in-0' has 1 subscriber(s).
2021-08-26 12:40:28.474  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel errorChannel
2021-08-26 12:40:28.527  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel fizzBuzzProducer_integrationflow.channel#0
2021-08-26 12:40:28.539  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel fizzBuzzProcessor-out-0
2021-08-26 12:40:28.558  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel fizzBuzzProcessor-in-0
2021-08-26 12:40:28.562  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel nullChannel
2021-08-26 12:40:28.567  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel fizzBuzzProducer-out-0
2021-08-26 12:40:28.571  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel fizzBuzzConsumer-in-0
2021-08-26 12:40:28.577  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageHandler fizzBuzzProducer_integrationflow.org.springframework.integration.config.ConsumerEndpointFactoryBean#0
2021-08-26 12:40:28.615  INFO 2917 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageHandler _org.springframework.integration.errorLogger
2021-08-26 12:40:28.627  INFO 2917 --- [           main] o.s.i.endpoint.EventDrivenConsumer       : Adding {logging-channel-adapter:_org.springframework.integration.errorLogger} as a subscriber to the 'errorChannel' channel
2021-08-26 12:40:28.627  INFO 2917 --- [           main] o.s.i.channel.PublishSubscribeChannel    : Channel 'application.errorChannel' has 1 subscriber(s).
2021-08-26 12:40:28.628  INFO 2917 --- [           main] o.s.i.endpoint.EventDrivenConsumer       : started bean '_org.springframework.integration.errorLogger'
2021-08-26 12:40:28.644  INFO 2917 --- [           main] o.s.i.endpoint.ReactiveStreamsConsumer   : started bean 'fizzBuzzProducer_integrationflow.org.springframework.integration.config.ConsumerEndpointFactoryBean#0'
2021-08-26 12:40:28.645  INFO 2917 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Retrieving cached binder: kafka
2021-08-26 12:40:28.709  INFO 2917 --- [           main] o.s.c.s.b.k.p.KafkaTopicProvisioner      : Using kafka topic for outbound: numbers
2021-08-26 12:40:28.712  INFO 2917 --- [           main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	 --- [           main] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2021-08-26 12:40:29.186  INFO 2917 --- [           main] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2021-08-26 12:40:29.187  INFO 2917 --- [           main] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-1 unregistered
2021-08-26 12:40:29.215  INFO 2917 --- [           main] o.s.c.stream.binder.BinderErrorChannel   : Channel 'numbers.anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0.errors' has 1 subscriber(s).
2021-08-26 12:40:29.215  INFO 2917 --- [           main] o.s.c.stream.binder.BinderErrorChannel   : Channel 'numbers.anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0.errors' has 0 subscriber(s).
2021-08-26 12:40:29.215  INFO 2917 --- [           main] o.s.c.stream.binder.BinderErrorChannel   : Channel 'numbers.anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0.errors' has 1 subscriber(s).
2021-08-26 12:40:29.215  INFO 2917 --- [           main] o.s.c.stream.binder.BinderErrorChannel   : Channel 'numbers.anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0.errors' has 2 subscriber(s).
2021-08-26 12:40:29.229  INFO 2917 --- [           main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 100
	org.apache.kafka.common.serialization.ByteArrayDeserializer

2021-08-26 12:40:29.389  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] (Re-)joining group
2021-08-26 12:40:29.390  INFO 2917 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 2.7.1
2021-08-26 12:40:29.390  INFO 2917 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 61dbce85d0d41457
2021-08-26 12:40:29.390  INFO 2917 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1629961829390
2021-08-26 12:40:29.390  INFO 2917 --- [           main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Subscribed to topic(s): fizz-buzz
2021-08-26 12:40:29.391  INFO 2917 --- [           main] s.i.k.i.KafkaMessageDrivenChannelAdapter : started org.springframework.integration.kafka.inbound.KafkaMessageDrivenChannelAdapter@5ab63a04
2021-08-26 12:40:29.406  INFO 2917 --- [container-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Cluster ID: jGpZSsM1QYyHKuc0Eu2XLA
2021-08-26 12:40:29.407  INFO 2917 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9001 (http) with context path ''
2021-08-26 12:40:29.408  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2021-08-26 12:40:29.408  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] (Re-)joining group
2021-08-26 12:40:29.417  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] (Re-)joining group
2021-08-26 12:40:29.429  INFO 2917 --- [           main] udStreamFunctionalProgrammingApplication : Started SpringCloudStreamFunctionalProgrammingApplication in 2.861 seconds (JVM running for 8.377)
2021-08-26 12:40:32.415  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Successfully joined group with generation Generation{generationId=1, memberId='consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2-174e955e-269f-4f0e-9ad3-7799742ca770', protocol='range'}
2021-08-26 12:40:32.418  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Finished assignment for group at generation 1: {consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2-174e955e-269f-4f0e-9ad3-7799742ca770=Assignment(partitions=[numbers-0])}
2021-08-26 12:40:32.422  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Successfully joined group with generation Generation{generationId=1, memberId='consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4-70428fe6-70b3-41d9-8280-b8105e0ce762', protocol='range'}
2021-08-26 12:40:32.422  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Finished assignment for group at generation 1: {consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4-70428fe6-70b3-41d9-8280-b8105e0ce762=Assignment(partitions=[fizz-buzz-0])}
2021-08-26 12:40:32.480  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Successfully synced group in generation Generation{generationId=1, memberId='consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4-70428fe6-70b3-41d9-8280-b8105e0ce762', protocol='range'}
2021-08-26 12:40:32.480  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Successfully synced group in generation Generation{generationId=1, memberId='consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2-174e955e-269f-4f0e-9ad3-7799742ca770', protocol='range'}
2021-08-26 12:40:32.480  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Notifying assignor about the new Assignment(partitions=[fizz-buzz-0])
2021-08-26 12:40:32.480  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Notifying assignor about the new Assignment(partitions=[numbers-0])
2021-08-26 12:40:32.482  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Adding newly assigned partitions: numbers-0
2021-08-26 12:40:32.482  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Adding newly assigned partitions: fizz-buzz-0
2021-08-26 12:40:32.491  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Found no committed offset for partition numbers-0
2021-08-26 12:40:32.491  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Found no committed offset for partition fizz-buzz-0
2021-08-26 12:40:32.496  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Found no committed offset for partition fizz-buzz-0
2021-08-26 12:40:32.496  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Found no committed offset for partition numbers-0
2021-08-26 12:40:32.514  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847-4, groupId=anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847] Resetting offset for partition fizz-buzz-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2021-08-26 12:40:32.514  INFO 2917 --- [container-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0-2, groupId=anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0] Resetting offset for partition numbers-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2021-08-26 12:40:32.539  INFO 2917 --- [container-0-C-1] o.s.c.s.b.k.KafkaMessageChannelBinder$2  : anonymous.ac088754-30d4-45e9-87c3-071bc7a661d0: partitions assigned: [numbers-0]
2021-08-26 12:40:32.539  INFO 2917 --- [container-0-C-1] o.s.c.s.b.k.KafkaMessageChannelBinder$2  : anonymous.4673ffb3-55d5-49fe-8cbb-9b8934ba3847: partitions assigned: [fizz-buzz-0]
2021-08-26 12:40:34.062  INFO 2917 --- [     parallel-1] reactor.Flux.Map.2                       : onNext(7536)
2021-08-26 12:40:34.093  INFO 2917 --- [oundedElastic-1] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = 1
	batch.size = 16384

2021-08-26 12:40:34.165  INFO 2917 --- [container-0-C-1] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 2.7.1
2021-08-26 12:40:34.165  INFO 2917 --- [container-0-C-1] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 61dbce85d0d41457
2021-08-26 12:40:34.165  INFO 2917 --- [container-0-C-1] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1629961834165
2021-08-26 12:40:34.171  INFO 2917 --- [ad | producer-4] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-4] Cluster ID: jGpZSsM1QYyHKuc0Eu2XLA
2021-08-26 12:40:34.181  INFO 2917 --- [container-0-C-1] c.cloud.stream.kafka.KafkaConfiguration  : Consumer Received : Fizz
2021-08-26 12:40:39.060  INFO 2917 --- [     parallel-1] reactor.Flux.Map.2                       : onNext(7061)
2021-08-26 12:40:39.070  INFO 2917 --- [container-0-C-1] reactor.Flux.Map.1                       : onNext(7061)
2021-08-26 12:40:39.079  INFO 2917 --- [container-0-C-1] c.cloud.stream.kafka.KafkaConfiguration  : Consumer Received : 7061
2021-08-26 12:40:44.054  INFO 2917 --- [     parallel-1] reactor.Flux.Map.2                       : onNext(1952)
2021-08-26 12:40:44.061  INFO 2917 --- [container-0-C-1] reactor.Flux.Map.1                       : onNext(1952)
2021-08-26 12:40:44.067  INFO 2917 --- [container-0-C-1] c.cloud.stream.kafka.KafkaConfiguration  : Consumer Received : 1952
2021-08-26 12:40:49.053  INFO 2917 --- [     parallel-1] reactor.Flux.Map.2                       : onNext(4424)
2021-08-26 12:40:49.061  INFO 2917 --- [container-0-C-1] reactor.Flux.Map.1                       : onNext(4424)
2021-08-26 12:40:49.067  INFO 2917 --- [container-0-C-1] c.cloud.stream.kafka.KafkaConfiguration  : Consumer Received : 4424
-------------

```